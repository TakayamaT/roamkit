(function () {var e={};var f,g,j={},a=j={};function m(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function q($){if(f===setTimeout)return setTimeout($,0);if((f===m||!f)&&setTimeout)return f=setTimeout,setTimeout($,0);try{return f($,0)}catch(e){try{return f.call(null,$,0)}catch(e){return f.call(this,$,0)}}}function H($){if(g===clearTimeout)return clearTimeout($);if((g===n||!g)&&clearTimeout)return g=clearTimeout,clearTimeout($);try{return g($)}catch(e){try{return g.call(null,$)}catch(e){return g.call(this,$)}}}!function(){try{f="function"==typeof setTimeout?setTimeout:m}catch($){f=m}try{g="function"==typeof clearTimeout?clearTimeout:n}catch($){g=n}}();var i,d=[],o=!1,r=-1;function I(){o&&i&&(o=!1,i.length?d=i.concat(d):r=-1,d.length&&s())}function s(){if(!o){var $=q(I);o=!0;for(var e=d.length;e;){for(i=d,d=[];++r<e;)i&&i[r].run();r=-1,e=d.length}i=null,o=!1,H($)}}function t($,e){this.fun=$,this.array=e}function c(){}a.nextTick=function($){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];d.push(new t($,e)),1!==d.length||o||q(s)},t.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.env={},a.argv=[],a.version="",a.versions={},a.on=c,a.addListener=c,a.once=c,a.off=c,a.removeListener=c,a.removeAllListeners=c,a.emit=c,a.prependListener=c,a.prependOnceListener=c,a.listeners=function($){return[]},a.binding=function($){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function($){throw new Error("process.chdir is not supported")},a.umask=function(){return 0};var b={},J=b&&b.__spreadArrays||function(){for(var e=0,r=0,o=arguments.length;r<o;r++)e+=arguments[r].length;var t=Array(e),n=0;for(r=0;r<o;r++)for(var $=arguments[r],i=0,s=$.length;i<s;i++,n++)t[n]=$[i];return t},u=function(){return function(e,r,o){this.name=e,this.version=r,this.os=o,this.type="browser"}}();b.BrowserInfo=u;var v=function(){return function(e){this.version=e,this.type="node",this.name="node",this.os=j.platform}}();b.NodeInfo=v;var w=function(){return function(e,r,o,t){this.name=e,this.version=r,this.os=o,this.bot=t,this.type="bot-device"}}();b.SearchBotDeviceInfo=w;var x=function(){return function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}}();b.BotInfo=x;var y=function(){return function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}}();b.ReactNativeInfo=y;var K=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,L=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,z=3,M=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",K]],A=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function B(e){return e?p(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new y:"undefined"!=typeof navigator?p(navigator.userAgent):E()}function C(e){return""!==e&&M.reduce(function(r,o){var t=o[0],n=o[1];if(r)return r;var $=n.exec(e);return!!$&&[t,$]},!1)}function N(e){var r=C(e);return r?r[0]:null}function p(e){var r=C(e);if(!r)return null;var o=r[0],t=r[1];if("searchbot"===o)return new x;var n=t[1]&&t[1].split(/[._]/).slice(0,3);n?n.length<z&&(n=J(n,O(z-n.length))):n=[];var $=n.join("."),i=D(e),s=L.exec(e);return s&&s[1]?new w(o,$,i,s[1]):new u(o,$,i)}function D(e){for(var r=0,o=A.length;r<o;r++){var t=A[r],n=t[0];if(t[1].exec(e))return n}return null}function E(){return void 0!==j&&j.version?new v(j.version.slice(1)):null}function O(e){for(var r=[],o=0;o<e;o++)r.push("0");return r}b.detect=B,b.browserName=N,b.parseUserAgent=p,b.detectOS=D,b.getNodeVersion=E;var F=e&&e.__assign||function(){return(F=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e}).apply(this,arguments)},h=function(e,n,t){var r,a=(n=n||{})&&void 0!==n.offset?e.text.substring(n.offset):e.text;if(e.voice&&"native"===e.voice.voiceURI)(r=e).text=a,r.addEventListener("end",function(){h.cancel&&(h.cancel=!1),void 0!==t&&t()});else{var o=n&&n.chunkLength||160,$=new RegExp("^[\\s\\S]{"+Math.floor(o/2)+","+o+"}[.!?,]{1}|^[\\s\\S]{1,"+o+"}$|^[\\s\\S]{1,"+o+"} "),i=a.match($);if(void 0===i[0]||i[0].length<=2)return void(void 0!==t&&t());var c,s=i[0];for(c in r=new SpeechSynthesisUtterance(s),e)e.hasOwnProperty(c)&&"text"!==c&&(r[c]=e[c]);r.addEventListener("end",function(){h.cancel?h.cancel=!1:(n.offset=n.offset||0,n.offset+=s.length-1,h(e,n,t))})}n.modifier&&n.modifier(r),console.log(r),setTimeout(function(){speechSynthesis.speak(r)},0)},P={debug:!1,voiceSelector:function(e,n){var t=n.filter(function(e){return"en-US"===e.lang}),r=t.filter(function(e){return e.name.includes("Natural")||e.name.includes("Google")});return 0===r.length?t[0]:r[0]},utterHandler:function(e){}},k=F(F({},P),null===window||void 0===window?void 0:window.readAloud),l=function(e){!0===k.debug&&console.log("read-aloud: "+e)},Q=function(e){return"readAloud"===e.dataset.readAloud||(e.dataset.readAloud="readAloud",!1)},G=!1;window.speechSynthesis.onvoiceschanged=function(){G=!0};var R=function(e,n){var t=B();l("browser: "+t.name),e.addEventListener("click",function(){speechSynthesis.speaking?speechSynthesis.cancel():new Promise(function(e){var n=setInterval(function(){l(G),!0===G&&(clearInterval(n),e()),l("voices-count: "+speechSynthesis.getVoices().length),0!==speechSynthesis.getVoices().length&&(G=!0,clearInterval(n),e())},500)}).then(function(){var e=k.voiceSelector(t.name,speechSynthesis.getVoices()),r=new SpeechSynthesisUtterance(n.textContent);r.voice=e,h(r,{chunkLength:120,modifier:function(n){n.voice=e,void 0!==k.utterHandler&&k.utterHandler(r)}})})})},S=function(e){if(!Q(e)){var n=e.closest(".rm-block-main").nextElementSibling;R(e,n)}},T=function(){var e=Array.from(document.querySelectorAll("button")).filter(function(e){return"read"===e.textContent});l("found buttons: "+e.length),e.forEach(function(e){S(e)})};setInterval(T,1e3);if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e}else if(typeof define==="function"&&define.amd){define(function(){return e})}})();